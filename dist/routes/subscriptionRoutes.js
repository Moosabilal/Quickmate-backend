import express from "express";
import { authenticateToken, authorizeRoles } from "../middleware/authMiddleware.js";
import { container } from "../di/container.js";
import TYPES from "../di/type.js";
import {} from "../controllers/subscriptionPlanController.js";
const router = express.Router();
const subscriptionController = container.get(TYPES.SubscriptionPlanController);
const isAdmin = [authenticateToken, authorizeRoles(["Admin"])];
const isAdminOrUser = [authenticateToken, authorizeRoles(["Admin", "ServiceProvider"])];
const isProvider = [authenticateToken, authorizeRoles(["ServiceProvider"])];
router.post("/createSubscriptionPlan", isAdmin, subscriptionController.createSubscriptionPlan);
router.get("/getSubscriptionPlan", isAdminOrUser, subscriptionController.getSubscriptionPlan);
router.put("/updateSubscriptionPlan", isAdmin, subscriptionController.updateSubscriptionPlan);
router.delete("/deleteSubscriptionPlan/:id", isAdmin, subscriptionController.deleteSubscriptionPlan);
router.get("/:providerId/check", isProvider, subscriptionController.checkProviderSubscription);
router.post("/create-order", isProvider, subscriptionController.createSubscriptionOrder);
router.post("/verify-payment", isProvider, subscriptionController.verifySubscriptionPayment);
router.post("/calculate-upgrade", isProvider, subscriptionController.calculateUpgrade);
router.post("/schedule-downgrade", isProvider, subscriptionController.scheduleDowngrade);
router.post("/cancel-downgrade", isProvider, subscriptionController.cancelDowngrade);
export default router;
